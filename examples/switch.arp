[macro! params [do!
  [let! expression [[head params]]]
  [let-mut! cases [tail params]]
  [loop! [do!
    [decide! [empty? cases]
      [break! []]
      []
    ]
    [let! current [head cases]]
    [decide! [empty? [tail current]]
      [break! [[head current]]]
      []
    ]
    [let! condition [head current]]
    [decide! [= expression [condition]]
      [do!
        [let! value [head [tail current]]]
        [break! [value]]
      ]
      [assign! cases [tail cases]]
    ]
  ]]
]]
